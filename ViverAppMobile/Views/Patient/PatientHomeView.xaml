<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    x:Class="ViverAppMobile.Views.Patient.PatientHomeView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:behaviors="clr-namespace:ViverAppMobile.Behaviors"
    xmlns:controls="clr-namespace:ViverAppMobile.Controls"
    xmlns:converter="clr-namespace:ViverAppMobile.Converters"
    xmlns:vm="clr-namespace:ViverAppMobile.ViewModels.Patient"
    x:Name="PatientHomePage"
    BackgroundColor="{StaticResource PageBackground}">

    <ContentView.BindingContext>
        <vm:PatientHomeViewModel />
    </ContentView.BindingContext>

    <ContentView.Resources>
        <ResourceDictionary>
            <converter:InverseBoolConverter x:Key="InverseBoolConverter" />
            <converter:SelectedValueToColorConverter x:Key="ValueToBackgroundColorConverter" />
            <converter:SelectedValueToColorConverter x:Key="ValueToBorderColorConverter" />
            <converter:ScheduleStatusToColorConverter x:Key="ScheduleStatusToColorConverter" />
            <converter:SelectedValueToColorConverter x:Key="ValueToButtonColorConverter" SelectedColor="Purple" />
            <converter:SelectedValueToColorConverter
                x:Key="ValueToLabelColorConveter"
                SelectedColor="Purple"
                UnselectedColor="CornflowerBlue" />
            <converter:SelectedValueToColorConverter
                x:Key="ValueToTextColorConveter"
                SelectedColor="White"
                UnselectedColor="Black" />
        </ResourceDictionary>
    </ContentView.Resources>

    <RefreshView Command="{Binding ReloadPageCommand}" IsRefreshing="{Binding IsReloading}">
        <ScrollView>
            <VerticalStackLayout Padding="15" Spacing="20">
                <Grid ColumnDefinitions="*,Auto" VerticalOptions="Center">
                    <StackLayout Spacing="4">
                        <HorizontalStackLayout Spacing="5">
                            <Label
                                FontAttributes="Bold"
                                FontSize="18"
                                TextColor="Black">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="Olá, " />
                                        <Span FontAttributes="Bold" Text="{Binding UserName}" />
                                        <Span FontAttributes="Bold" Text="!" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                            <Label
                                FontFamily="AppIcons"
                                FontSize="18"
                                IsVisible="{Binding IsUserPremium}"
                                Text="&#xe844;"
                                TextColor="Gold"
                                VerticalTextAlignment="Center" />
                        </HorizontalStackLayout>
                        <Label
                            FontSize="12"
                            Text="Como está sua visão hoje?"
                            TextColor="DarkSlateGray" />
                    </StackLayout>
                    <Border
                        Grid.Column="2"
                        BackgroundColor="White"
                        HeightRequest="25"
                        StrokeShape="RoundRectangle 6">

                        <Border.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding OpenMenuCommand}" />
                        </Border.GestureRecognizers>

                        <HorizontalStackLayout Padding="15,0,15,0" Spacing="12">
                            <Label
                                FontFamily="AppIcons"
                                FontSize="12"
                                Text="&#xf0c9;"
                                VerticalTextAlignment="Center" />
                            <Label
                                FontSize="12"
                                Text="Menu"
                                VerticalTextAlignment="Center" />
                        </HorizontalStackLayout>
                    </Border>
                </Grid>

                <Border Stroke="Transparent" StrokeShape="8">
                    <VerticalStackLayout Spacing="6">
                        <CarouselView
                            x:Name="ImageCarousel"
                            HeightRequest="280"
                            HorizontalOptions="Fill"
                            HorizontalScrollBarVisibility="Never"
                            IndicatorView="indicator"
                            IsScrollAnimated="True"
                            ItemsSource="{Binding CarouselItems}"
                            Loop="False"
                            VerticalOptions="Start">

                            <CarouselView.ItemTemplate>
                                <DataTemplate>
                                    <Border Stroke="{Binding IconBackColor}" StrokeShape="8">
                                        <Grid HorizontalOptions="Fill" VerticalOptions="Fill">
                                            <Image
                                                Aspect="AspectFill"
                                                HorizontalOptions="Fill"
                                                Source="{Binding Image}"
                                                VerticalOptions="Fill" />

                                            <VerticalStackLayout
                                                Margin="0,23,0,0"
                                                Padding="15"
                                                Spacing="40">
                                                <Grid
                                                    Margin="5,0,0,0"
                                                    ColumnDefinitions="Auto,*"
                                                    ColumnSpacing="20">
                                                    <Border
                                                        Grid.Column="0"
                                                        Padding="10,10,10,8"
                                                        BackgroundColor="{Binding IconBackColor}"
                                                        Stroke="Transparent"
                                                        StrokeShape="14"
                                                        VerticalOptions="Center">
                                                        <Label
                                                            FontFamily="AppIcons"
                                                            FontSize="28"
                                                            Text="{Binding Icon}"
                                                            TextColor="White" />
                                                    </Border>

                                                    <VerticalStackLayout
                                                        Grid.Column="1"
                                                        Spacing="4"
                                                        VerticalOptions="Center">

                                                        <VerticalStackLayout.Margin>
                                                            <OnPlatform>
                                                                <On Platform="Android" Value="6,0,0,0" />
                                                                <On Platform="WinUI" Value="0" />
                                                            </OnPlatform>
                                                        </VerticalStackLayout.Margin>

                                                        <Label
                                                            FontAttributes="Bold"
                                                            FontSize="18"
                                                            Text="{Binding Title}"
                                                            TextColor="White" />
                                                        <Label
                                                            FontAttributes="Bold"
                                                            FontSize="12"
                                                            Text="{Binding Subtitle}"
                                                            TextColor="LightBlue" />
                                                    </VerticalStackLayout>
                                                </Grid>

                                                <Border
                                                    Margin="{Binding Margin}"
                                                    BackgroundColor="Transparent"
                                                    Stroke="Transparent"
                                                    Style="{StaticResource MasterBorderStyle}">
                                                    <Label
                                                        FontFamily="Semibold"
                                                        FontSize="13"
                                                        LineHeight="1.5"
                                                        Text="{Binding Info}"
                                                        TextColor="White" />
                                                </Border>
                                            </VerticalStackLayout>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </CarouselView.ItemTemplate>
                        </CarouselView>

                        <Grid ColumnDefinitions="*,*,*" ColumnSpacing="10">
                            <Label
                                Grid.Column="0"
                                FontFamily="AppIcons"
                                FontSize="13"
                                HorizontalTextAlignment="End"
                                Text="&#xe815;"
                                TextColor="Gray"
                                VerticalTextAlignment="Center">

                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="PreviousCarouselImage" />
                                </Label.GestureRecognizers>
                            </Label>

                            <IndicatorView
                                x:Name="indicator"
                                Grid.Column="1"
                                Margin="0,8,0,8"
                                HorizontalOptions="Center"
                                IndicatorColor="Gray"
                                SelectedIndicatorColor="Blue" />

                            <Label
                                Grid.Column="2"
                                FontFamily="AppIcons"
                                FontSize="13"
                                HorizontalTextAlignment="Start"
                                Text="&#xe813;"
                                TextColor="Gray"
                                VerticalTextAlignment="Center">

                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="NextCarouselImage" />
                                </Label.GestureRecognizers>
                            </Label>
                        </Grid>
                    </VerticalStackLayout>
                </Border>

                <Border
                    Padding="20"
                    BackgroundColor="#edf3ff"
                    IsVisible="{Binding UserHasNextAppointment, Converter={StaticResource InverseBoolConverter}}"
                    Shadow="{StaticResource BottomShadow}"
                    Stroke="#D0E0FF"
                    StrokeShape="12">
                    <VerticalStackLayout Spacing="14">
                        <VerticalStackLayout Spacing="8">
                            <HorizontalStackLayout Spacing="8">
                                <Label
                                    FontFamily="AppIcons"
                                    Text="&#xe81a;"
                                    TextColor="CornflowerBlue" />
                                <Label>
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span FontFamily="" Text="Bem-vindo ao Vi" />
                                            <Span
                                                FontFamily=""
                                                Text="ver"
                                                TextColor="Blue" />
                                            <Span FontFamily="" Text="!" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                            </HorizontalStackLayout>

                            <Label
                                FontFamily=""
                                FontSize="12"
                                Text="Que bom ter você conosco"
                                TextColor="Gray" />

                        </VerticalStackLayout>
                        <FlexLayout JustifyContent="Center">
                            <Border
                                Padding="12"
                                BackgroundColor="#dbeafe"
                                Stroke="#dbe2fe"
                                StrokeShape="80">
                                <Label
                                    Padding="2,2,0,2"
                                    FontFamily="AppIcons"
                                    FontSize="24"
                                    Text="&#xe819;"
                                    TextColor="#1358ed" />
                            </Border>
                        </FlexLayout>

                        <Label
                            FontFamily=""
                            FontSize="13"
                            HorizontalTextAlignment="Center"
                            Text="Sua consulta nos aguarda!"
                            TextColor="#35509c" />
                        <Label
                            FontFamily=""
                            FontSize="12"
                            HorizontalTextAlignment="Center"
                            LineHeight="1.5"
                            Text="Agende sua consulta oftamológica conosco e tenha acesso aos melhores especialistas da região."
                            TextColor="CornflowerBlue" />

                        <Border
                            Padding="14"
                            BackgroundColor="#dbebff"
                            Stroke="Transparent"
                            StrokeShape="8">
                            <VerticalStackLayout Spacing="8">
                                <Label FontSize="12" TextColor="#3051bf">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span FontFamily="AppIcons" Text="&#xe809;" />
                                            <Span Text="  Médicos especializados em oftamologia" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                                <Label FontSize="12" TextColor="#3051bf">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span FontFamily="AppIcons" Text="&#xe801;" />
                                            <Span Text="  Atendimento rápido e humanizado" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                                <Label FontSize="12" TextColor="#3051bf">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span FontFamily="AppIcons" Text="&#xe800;" />
                                            <Span Text="  Localização privilegiada" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                                <Label FontSize="12" TextColor="#3051bf">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span FontFamily="AppIcons" Text="&#xe818;" />
                                            <Span Text="  Facilidade e rapidez para agendar consultas" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                            </VerticalStackLayout>
                        </Border>

                        <Border
                            Padding="7"
                            BackgroundColor="#145efc"
                            StrokeShape="8">

                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SwitchToSchedulePageCommand}" />
                            </Border.GestureRecognizers>

                            <Label
                                FontSize="12"
                                HorizontalTextAlignment="Center"
                                TextColor="White">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span FontFamily="AppIcons" Text="&#xf133;" />
                                        <Span FontAttributes="Bold" Text="     Agendar minha consulta     " />
                                        <Span FontFamily="AppIcons" Text="&#xe813;" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                        </Border>
                    </VerticalStackLayout>
                </Border>

                <Border
                    Padding="20"
                    BackgroundColor="White"
                    IsVisible="{Binding UserHasNextAppointment}"
                    Shadow="{StaticResource BottomShadow}"
                    StrokeShape="12"
                    StrokeThickness="0.5">

                    <VerticalStackLayout Spacing="12">
                        <StackLayout Spacing="8">
                            <HorizontalStackLayout Spacing="8">
                                <Label
                                    FontFamily="AppIcons"
                                    FontSize="18"
                                    Text="&#xf133;"
                                    TextColor="CornflowerBlue"
                                    VerticalTextAlignment="Center" />
                                <Label FontSize="18" VerticalTextAlignment="Center">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span FontAttributes="Bold" Text="Próxim" />
                                            <Span FontAttributes="Bold" Text="{Binding NextAppointmentTypeSufix}" />
                                            <Span Text=" " />
                                            <Span FontAttributes="Bold" Text="{Binding NextAppointmentType}" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                            </HorizontalStackLayout>

                            <Label FontSize="12" TextColor="Gray">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="{Binding NextAppointmentTypePrefix}" />
                                        <Span Text=" próxim" />
                                        <Span Text="{Binding NextAppointmentTypeSufix}" />
                                        <Span Text=" " />
                                        <Span Text="{Binding NextAppointmentType}" />
                                        <Span Text=" está marcad" />
                                        <Span Text="{Binding NextAppointmentTypeSufix}" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                        </StackLayout>

                        <Border
                            Padding="3,0,0,0"
                            BackgroundColor="DarkOrange"
                            IsVisible="{Binding NextAppointmentWasRescheduled}"
                            StrokeThickness="0">
                            <Border
                                Padding="10,18,18,18"
                                BackgroundColor="#fff7ed"
                                StrokeThickness="0">
                                <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="6">
                                    <Label
                                        Grid.Column="0"
                                        FontFamily="AppIcons"
                                        Text="&#xe81c;"
                                        TextColor="DarkOrange"
                                        VerticalTextAlignment="Center" />
                                    <StackLayout Grid.Column="1" Spacing="5">
                                        <Label
                                            FontAttributes="Bold"
                                            FontSize="12"
                                            Text="Consulta reagendada"
                                            TextColor="DarkRed" />
                                        <Label FontSize="10" TextColor="DarkRed">
                                            <Label.FormattedText>
                                                <FormattedString>
                                                    <Span Text="Data Original: " />
                                                    <Span Text="{Binding NextAppointmentOriginalDate}" />
                                                </FormattedString>
                                            </Label.FormattedText>
                                        </Label>
                                    </StackLayout>
                                    <Border
                                        Grid.Column="2"
                                        Padding="10,2,10,2"
                                        BackgroundColor="#ffedd4"
                                        HeightRequest="25"
                                        Stroke="Transparent"
                                        StrokeShape="8">
                                        <Label
                                            FontSize="11"
                                            TextColor="DarkRed"
                                            VerticalTextAlignment="Center">
                                            <Label.FormattedText>
                                                <FormattedString>
                                                    <Span FontFamily="AppIcons" Text="&#xf0ec;" />
                                                    <Span Text="  Reagendada" />
                                                </FormattedString>
                                            </Label.FormattedText>
                                        </Label>
                                    </Border>
                                </Grid>
                            </Border>
                        </Border>

                        <StackLayout IsVisible="{Binding NextAppointmentPendingPayment}">
                            <Border
                                Padding="3,0,0,0"
                                BackgroundColor="Red"
                                StrokeThickness="0">
                                <Border
                                    Padding="10,18,18,18"
                                    BackgroundColor="#fef2f2"
                                    StrokeThickness="0">
                                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="10">
                                        <Label
                                            Grid.Column="0"
                                            FontFamily="AppIcons"
                                            Text="&#xf155;"
                                            TextColor="Red"
                                            VerticalTextAlignment="Center" />
                                        <StackLayout Grid.Column="1" Spacing="5">
                                            <Label
                                                FontAttributes="Bold"
                                                FontSize="12"
                                                Text="Pagamento pendente"
                                                TextColor="DarkRed" />
                                            <Label
                                                FontSize="11"
                                                Text="Consulta confirmada mas aguardando pagamento na recepção"
                                                TextColor="DarkRed" />
                                        </StackLayout>
                                    </Grid>
                                </Border>
                            </Border>
                        </StackLayout>

                        <FlexLayout
                            Margin="0,2,0,0"
                            Direction="Row"
                            JustifyContent="SpaceBetween">
                            <StackLayout Spacing="2">
                                <Label
                                    Padding="0,8,0,0"
                                    FontSize="14"
                                    TextColor="DarkBlue">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span Text="Médico: " />
                                            <Span Text="{Binding NextAppointmentDoctorName}" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                                <Label
                                    FontSize="12"
                                    Text="{Binding NextAppointmentDoctorMainSpecialty}"
                                    TextColor="MediumBlue">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span Text="Especialidade: " />
                                            <Span Text="{Binding NextAppointmentDoctorMainSpecialty}" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                            </StackLayout>

                            <Border
                                Margin="0,10"
                                Padding="6"
                                BackgroundColor="{Binding NextAppointmentStatusID, Converter={StaticResource ScheduleStatusToColorConverter}}"
                                Stroke="Transparent"
                                StrokeShape="RoundRectangle 4"
                                VerticalOptions="Center">
                                <Label
                                    FontSize="11"
                                    Text="{Binding NextAppointmentStatus}"
                                    TextColor="Black" />
                            </Border>
                        </FlexLayout>

                        <Border
                            Margin="0,-15,0,0"
                            Padding="10"
                            BackgroundColor="{StaticResource BackgroundGray}"
                            Stroke="Transparent">
                            <VerticalStackLayout Spacing="12">
                                <Grid
                                    Margin="0,0,0,0"
                                    ColumnDefinitions="Auto,*,1.2*"
                                    ColumnSpacing="6">
                                    <Label
                                        Grid.Column="0"
                                        FontFamily="AppIcons"
                                        FontSize="12"
                                        Text="&#xf133;"
                                        TextColor="CornflowerBlue"
                                        VerticalTextAlignment="Center" />
                                    <Label
                                        Grid.Column="1"
                                        FontSize="12"
                                        Text="{Binding NextAppointmentDate}"
                                        TextColor="Black"
                                        VerticalTextAlignment="Center" />
                                    <Label
                                        Grid.Column="2"
                                        FontFamily="AppIcons"
                                        FontSize="12"
                                        Text="&#xe801;"
                                        TextColor="Black"
                                        VerticalTextAlignment="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span
                                                    FontFamily="AppIcons"
                                                    Text="&#xe801;"
                                                    TextColor="CornflowerBlue" />
                                                <Span Text=" " />
                                                <Span Text="{Binding NextAppointmentHour}" />
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                </Grid>

                                <Grid ColumnDefinitions="Auto,*" ColumnSpacing="6">
                                    <Label
                                        Grid.Column="0"
                                        Margin="0,2"
                                        FontFamily="AppIcons"
                                        FontSize="10"
                                        Text="{Binding ClinicIcon}"
                                        TextColor="CornflowerBlue"
                                        VerticalTextAlignment="Start" />
                                    <StackLayout Grid.Column="1">
                                        <Label
                                            FontSize="12"
                                            TextColor="Black"
                                            VerticalTextAlignment="Start">
                                            <Label.FormattedText>
                                                <FormattedString>
                                                    <Span FontAttributes="Bold" Text="{Binding ClinicName}" />
                                                    <Span FontAttributes="Bold" Text="{Binding ClinicComplement}" />
                                                </FormattedString>
                                            </Label.FormattedText>
                                        </Label>
                                        <Label
                                            FontSize="12"
                                            Text="{Binding ClinicFullAdress}"
                                            TextColor="Black" />
                                    </StackLayout>
                                </Grid>
                            </VerticalStackLayout>
                        </Border>

                        <Border
                            Padding="10,15,10,15"
                            BackgroundColor="#dbeafe"
                            Stroke="Transparent"
                            StrokeShape="8">
                            <StackLayout Spacing="4">
                                <Label FontSize="12">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span
                                                FontAttributes="Bold"
                                                Text="Tipo: "
                                                TextColor="DarkBlue" />
                                            <Span Text="{Binding NextAppointmentTitle}" TextColor="MediumBlue" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                                <Label FontSize="12">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span
                                                FontAttributes="Bold"
                                                Text="Observações: "
                                                TextColor="DarkBlue" />
                                            <Span Text="{Binding NextAppointmentNote}" TextColor="MediumBlue" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                            </StackLayout>
                        </Border>

                        <Grid
                            ColumnDefinitions="*,*"
                            ColumnSpacing="10"
                            RowDefinitions="30,30"
                            RowSpacing="10">
                            <Border
                                Grid.Row="0"
                                Grid.Column="0"
                                BackgroundColor="White"
                                Stroke="#CCCCCC"
                                StrokeShape="RoundRectangle 8">
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding PatientCallCommand}" />
                                </Border.GestureRecognizers>
                                <HorizontalStackLayout HorizontalOptions="Center" Spacing="4">
                                    <Label
                                        FontFamily="AppIcons"
                                        FontSize="12"
                                        HorizontalTextAlignment="Center"
                                        Text="&#xe804;"
                                        VerticalTextAlignment="Center" />
                                    <Label
                                        FontSize="12"
                                        HorizontalTextAlignment="Center"
                                        Text="Ligar"
                                        VerticalTextAlignment="Center" />
                                </HorizontalStackLayout>
                            </Border>
                            <Border
                                Grid.Row="0"
                                Grid.Column="1"
                                BackgroundColor="{Binding NextAppointmentIsOnline, Converter={StaticResource ValueToButtonColorConverter}, ConverterParameter={StaticResource TrueParam}}"
                                Stroke="#CCCCCC"
                                StrokeShape="RoundRectangle 8">
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding HowGetThereOrPushOnlineCommand}" />
                                </Border.GestureRecognizers>
                                <HorizontalStackLayout HorizontalOptions="Center" Spacing="4">
                                    <Label
                                        FontFamily="AppIcons"
                                        FontSize="12"
                                        HorizontalTextAlignment="Center"
                                        Text="{Binding HowToGetThereIcon}"
                                        TextColor="{Binding NextAppointmentIsOnline, Converter={StaticResource ValueToTextColorConveter}, ConverterParameter={StaticResource TrueParam}}"
                                        VerticalTextAlignment="Center" />
                                    <Label
                                        FontSize="12"
                                        HorizontalTextAlignment="Center"
                                        Text="{Binding HowToGetThereText}"
                                        TextColor="{Binding NextAppointmentIsOnline, Converter={StaticResource ValueToTextColorConveter}, ConverterParameter={StaticResource TrueParam}}"
                                        VerticalTextAlignment="Center" />
                                </HorizontalStackLayout>
                            </Border>
                            <Border
                                Grid.Row="1"
                                Grid.Column="0"
                                BackgroundColor="White"
                                Stroke="#CCCCCC"
                                StrokeShape="RoundRectangle 8">
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding RescheduleCommand}" />
                                </Border.GestureRecognizers>
                                <HorizontalStackLayout HorizontalOptions="Center" Spacing="4">
                                    <Label
                                        FontFamily="AppIcons"
                                        FontSize="12"
                                        HorizontalTextAlignment="Center"
                                        Text="&#xe80b;"
                                        TextColor="CornflowerBlue"
                                        VerticalTextAlignment="Center" />
                                    <Label
                                        FontSize="12"
                                        HorizontalTextAlignment="Center"
                                        Text="Remarcar"
                                        TextColor="CornflowerBlue"
                                        VerticalTextAlignment="Center" />
                                </HorizontalStackLayout>
                            </Border>
                            <Border
                                Grid.Row="1"
                                Grid.Column="1"
                                BackgroundColor="White"
                                Stroke="#CCCCCC"
                                StrokeShape="RoundRectangle 8">
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding CancelCommand}" />
                                </Border.GestureRecognizers>
                                <HorizontalStackLayout HorizontalOptions="Center" Spacing="4">
                                    <Label
                                        FontFamily="AppIcons"
                                        FontSize="12"
                                        HorizontalTextAlignment="Center"
                                        Text="&#xe80a;"
                                        TextColor="Red"
                                        VerticalTextAlignment="Center" />
                                    <Label
                                        FontSize="12"
                                        HorizontalTextAlignment="Center"
                                        Text="Cancelar"
                                        TextColor="Red"
                                        VerticalTextAlignment="Center" />
                                </HorizontalStackLayout>
                            </Border>
                        </Grid>

                        <Border
                            BackgroundColor="Blue"
                            IsVisible="{Binding NextAppointmentIsPending}"
                            StrokeThickness="0.3" />
                        <Border
                            Padding="5"
                            BackgroundColor="#00a63e"
                            IsVisible="{Binding NextAppointmentIsPending}"
                            StrokeShape="8">

                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SwitchToPaymentPageCommand}" />
                            </Border.GestureRecognizers>

                            <Label HorizontalTextAlignment="Center" TextColor="White">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span FontFamily="AppIcons" Text="&#xe805;" />
                                        <Span Text="  Efetuar Pagamento" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                        </Border>
                    </VerticalStackLayout>
                </Border>

                <Border
                    Padding="15,25,15,25"
                    BackgroundColor="#fffbeb"
                    IsVisible="{Binding IsNotUserPremium}"
                    Shadow="{StaticResource BottomShadow}"
                    Stroke="#fcf76f"
                    StrokeShape="12">

                    <Border.Behaviors>
                        <behaviors:BorderDismissBehavior />
                    </Border.Behaviors>

                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="6">
                        <Border
                            Padding="10"
                            BackgroundColor="#f0b000"
                            HorizontalOptions="Center"
                            Shadow="{StaticResource BottomShadow}"
                            Stroke="Transparent"
                            StrokeShape="RoundRectangle 30"
                            VerticalOptions="Center">
                            <Label
                                Padding="0,1,0,1"
                                FontAttributes="Bold"
                                FontFamily="AppIcons"
                                HorizontalTextAlignment="Center"
                                Text="&#xe80f;"
                                TextColor="White"
                                VerticalTextAlignment="Center" />
                        </Border>

                        <Grid
                            Grid.Column="1"
                            RowDefinitions="Auto,*,Auto,Auto"
                            RowSpacing="12">
                            <Label
                                Grid.Row="0"
                                FontAttributes="Bold"
                                FontSize="13"
                                Text="Torne-se Premium"
                                TextColor="SaddleBrown" />
                            <Label
                                Grid.Row="1"
                                FontSize="12"
                                HorizontalOptions="Fill"
                                LineBreakMode="WordWrap"
                                LineHeight="1.5"
                                MaxLines="3"
                                Text="Tenha acesso prioritário, consultas ilimitadas e descontos especiais em todos os procedimentos."
                                TextColor="SaddleBrown"
                                VerticalOptions="Fill" />

                            <Grid Grid.Row="2" ColumnDefinitions="*,*,*">
                                <Label
                                    Grid.Column="0"
                                    FontSize="11"
                                    TextColor="SaddleBrown"
                                    WidthRequest="90">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span FontFamily="AppIcons" Text="&#xe803;" />
                                            <Span Text=" Agendamento prioritário" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                                <Label
                                    Grid.Column="1"
                                    FontSize="11"
                                    TextColor="SaddleBrown"
                                    WidthRequest="90">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span FontFamily="AppIcons" Text="&#xe803;" />
                                            <Span Text=" Descontos de até 20%" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                                <Label
                                    Grid.Column="2"
                                    FontSize="11"
                                    TextColor="SaddleBrown"
                                    WidthRequest="90">
                                    <Label.FormattedText>
                                        <FormattedString>
                                            <Span FontFamily="AppIcons" Text="&#xe803;" />
                                            <Span Text=" SEM ANÚNCIOS!" />
                                        </FormattedString>
                                    </Label.FormattedText>
                                </Label>
                            </Grid>

                            <Border
                                Grid.Row="4"
                                Padding="8"
                                BackgroundColor="#d18800"
                                Stroke="Transparent"
                                StrokeShape="RoundRectangle 8">

                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding ShowPremiumPlansCommand}" />
                                </Border.GestureRecognizers>

                                <FlexLayout AlignItems="Center" JustifyContent="Center">
                                    <Label
                                        FontAttributes="Bold"
                                        FontFamily="AppIcons"
                                        FontSize="12"
                                        Text="&#xe80f;"
                                        TextColor="White" />
                                    <Label
                                        Padding="5,1.2,0,0"
                                        FontAttributes="Bold"
                                        FontFamily=""
                                        FontSize="14"
                                        Text="Conhecer Planos"
                                        TextColor="White" />
                                </FlexLayout>
                            </Border>
                        </Grid>
                    </Grid>
                </Border>

                <Border
                    Padding="18"
                    BackgroundColor="White"
                    Shadow="{StaticResource BottomShadow}"
                    StrokeShape="RoundRectangle 8"
                    StrokeThickness="0.5">

                    <Border.Behaviors>
                        <behaviors:BorderDismissBehavior />
                    </Border.Behaviors>

                    <StackLayout Spacing="20">
                        <StackLayout Spacing="7">
                            <Label FontSize="13" TextColor="Black">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span
                                            FontAttributes="Bold"
                                            FontFamily="AppIcons"
                                            Text="&#xe806;" />
                                        <Span FontAttributes="Bold" Text="  Cirurgias Disponíveis" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                            <Label
                                FontSize="12"
                                Text="Procedimentos cirúrgicos para sua saúde ocular"
                                TextColor="Gray" />
                        </StackLayout>

                        <CollectionView ItemsSource="{Binding AvailableSurgeries}">

                            <CollectionView.ItemsLayout>
                                <LinearItemsLayout ItemSpacing="5" Orientation="Vertical" />
                            </CollectionView.ItemsLayout>

                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        Padding="15"
                                        BackgroundColor="White"
                                        StrokeShape="12"
                                        StrokeThickness="0.6">
                                        <StackLayout>
                                            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="6">
                                                <Border
                                                    Padding="10"
                                                    BackgroundColor="#2b80ff"
                                                    HorizontalOptions="Center"
                                                    Shadow="{StaticResource BottomShadow}"
                                                    Stroke="Transparent"
                                                    StrokeShape="RoundRectangle 30"
                                                    VerticalOptions="Center">
                                                    <Label
                                                        Padding="0,1,0,1"
                                                        FontFamily="AppIcons"
                                                        HorizontalTextAlignment="Center"
                                                        Text="&#xe806;"
                                                        TextColor="White"
                                                        VerticalTextAlignment="Center" />
                                                </Border>

                                                <Grid
                                                    Grid.Column="1"
                                                    RowDefinitions="Auto,*,Auto,Auto"
                                                    RowSpacing="8">
                                                    <HorizontalStackLayout Grid.Row="0" Spacing="10">
                                                        <Label
                                                            FontAttributes="Bold"
                                                            FontSize="13"
                                                            Text="{Binding Title}" />
                                                        <Border
                                                            Padding="10,2,10,2"
                                                            BackgroundColor="#fffac2"
                                                            IsVisible="{Binding Ispopular}"
                                                            Stroke="Transparent"
                                                            StrokeShape="8">
                                                            <Label FontSize="10" TextColor="SaddleBrown">
                                                                <Label.FormattedText>
                                                                    <FormattedString>
                                                                        <Span FontFamily="AppIcons" Text="&#xe809;" />
                                                                        <Span Text=" Popular" />
                                                                    </FormattedString>
                                                                </Label.FormattedText>
                                                            </Label>
                                                        </Border>
                                                    </HorizontalStackLayout>
                                                    <Label
                                                        Grid.Row="1"
                                                        FontSize="12"
                                                        HorizontalOptions="Fill"
                                                        LineBreakMode="TailTruncation"
                                                        MaxLines="4"
                                                        Text="{Binding Description}"
                                                        TextColor="Gray"
                                                        VerticalOptions="Fill" />

                                                    <FlexLayout
                                                        Grid.Row="2"
                                                        Padding="0,0,15,0"
                                                        JustifyContent="SpaceBetween">
                                                        <VerticalStackLayout>
                                                            <Label
                                                                FontSize="11"
                                                                Text="Duração"
                                                                TextColor="Gray" />
                                                            <Label FontSize="11" TextColor="CornflowerBlue">
                                                                <Label.FormattedText>
                                                                    <FormattedString>
                                                                        <Span Text="{Binding Averagetime}" />
                                                                        <Span Text=" hrs" />
                                                                    </FormattedString>
                                                                </Label.FormattedText>
                                                            </Label>
                                                        </VerticalStackLayout>
                                                        <VerticalStackLayout>
                                                            <Label
                                                                FontSize="11"
                                                                Text="Especialista"
                                                                TextColor="Gray" />
                                                            <Label
                                                                FontSize="11"
                                                                Text="Dr Victor Justiniano"
                                                                TextColor="CornflowerBlue" />
                                                        </VerticalStackLayout>
                                                    </FlexLayout>
                                                </Grid>
                                            </Grid>

                                            <Border
                                                Padding="8"
                                                BackgroundColor="Black"
                                                Stroke="Transparent"
                                                StrokeShape="RoundRectangle 8">

                                                <Border.GestureRecognizers>
                                                    <TapGestureRecognizer Command="{Binding BindingContext.SwitchToSchedulePageSelectAppointmentCommand, Source={x:Reference PatientHomePage}}" CommandParameter="{Binding .}" />
                                                </Border.GestureRecognizers>

                                                <Label
                                                    FontSize="12"
                                                    HorizontalTextAlignment="Center"
                                                    TextColor="White"
                                                    VerticalTextAlignment="Center">
                                                    <Label.FormattedText>
                                                        <FormattedString>
                                                            <Span FontFamily="AppIcons" Text="&#xf133;" />
                                                            <Span FontAttributes="Bold" Text="   Agendar Cirurgia   " />
                                                            <Span FontFamily="AppIcons" Text="&#xe813;" />
                                                        </FormattedString>
                                                    </Label.FormattedText>
                                                </Label>
                                            </Border>
                                        </StackLayout>
                                    </Border>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </StackLayout>
                </Border>

                <Border
                    Padding="18"
                    BackgroundColor="White"
                    Shadow="{StaticResource BottomShadow}"
                    StrokeShape="RoundRectangle 8"
                    StrokeThickness="0.5">

                    <Border.Behaviors>
                        <behaviors:BorderDismissBehavior />
                    </Border.Behaviors>

                    <StackLayout Spacing="20">
                        <StackLayout Spacing="7">
                            <Label FontSize="13" TextColor="Black">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span
                                            FontAttributes="Bold"
                                            FontFamily="AppIcons"
                                            FontSize="16"
                                            Text="&#xe817;" />
                                        <Span FontAttributes="Bold" Text="  Exames Especializados" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                            <Label
                                FontSize="12"
                                Text="Exames diagnósticos avançados"
                                TextColor="Gray" />
                        </StackLayout>

                        <CollectionView ItemsSource="{Binding AvailableExams}">

                            <CollectionView.ItemsLayout>
                                <LinearItemsLayout ItemSpacing="5" Orientation="Vertical" />
                            </CollectionView.ItemsLayout>

                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        Padding="15"
                                        StrokeShape="12"
                                        StrokeThickness="0.6">
                                        <StackLayout>
                                            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="6">
                                                <Border
                                                    Padding="10"
                                                    BackgroundColor="DarkOrange"
                                                    HorizontalOptions="Center"
                                                    Shadow="{StaticResource BottomShadow}"
                                                    Stroke="Transparent"
                                                    StrokeShape="RoundRectangle 30"
                                                    VerticalOptions="Center">
                                                    <Label
                                                        Padding="0,1,0,1"
                                                        FontFamily="AppIcons"
                                                        HorizontalTextAlignment="Center"
                                                        Text="&#xe817;"
                                                        TextColor="White"
                                                        VerticalTextAlignment="Center" />
                                                </Border>

                                                <Grid
                                                    Grid.Column="1"
                                                    RowDefinitions="Auto,*,Auto,Auto"
                                                    RowSpacing="8">
                                                    <HorizontalStackLayout Grid.Row="0" Spacing="10">
                                                        <Label
                                                            FontAttributes="Bold"
                                                            FontSize="13"
                                                            Text="{Binding Title}" />
                                                        <Border
                                                            Padding="10,2,10,2"
                                                            BackgroundColor="#fffac2"
                                                            IsVisible="{Binding Ispopular}"
                                                            Stroke="Transparent"
                                                            StrokeShape="8">
                                                            <Label FontSize="10" TextColor="SaddleBrown">
                                                                <Label.FormattedText>
                                                                    <FormattedString>
                                                                        <Span FontFamily="AppIcons" Text="&#xe809;" />
                                                                        <Span Text=" Popular" />
                                                                    </FormattedString>
                                                                </Label.FormattedText>
                                                            </Label>
                                                        </Border>
                                                    </HorizontalStackLayout>
                                                    <Label
                                                        Grid.Row="1"
                                                        FontSize="12"
                                                        HorizontalOptions="Fill"
                                                        LineBreakMode="TailTruncation"
                                                        MaxLines="4"
                                                        Text="{Binding Description}"
                                                        TextColor="Gray"
                                                        VerticalOptions="Fill" />

                                                    <FlexLayout
                                                        Grid.Row="2"
                                                        Padding="0,0,15,0"
                                                        JustifyContent="SpaceBetween">
                                                        <VerticalStackLayout>
                                                            <Label
                                                                FontSize="11"
                                                                Text="Duração"
                                                                TextColor="Gray" />
                                                            <Label FontSize="11" TextColor="CornflowerBlue">
                                                                <Label.FormattedText>
                                                                    <FormattedString>
                                                                        <Span Text="{Binding Averagetime}" />
                                                                        <Span Text=" hrs" />
                                                                    </FormattedString>
                                                                </Label.FormattedText>
                                                            </Label>
                                                        </VerticalStackLayout>
                                                        <VerticalStackLayout>
                                                            <Label
                                                                FontSize="11"
                                                                Text="Especialista"
                                                                TextColor="Gray" />
                                                            <Label
                                                                FontSize="11"
                                                                Text="Dr Victor Justiniano"
                                                                TextColor="CornflowerBlue" />
                                                        </VerticalStackLayout>
                                                    </FlexLayout>
                                                </Grid>
                                            </Grid>

                                            <Border
                                                Padding="8"
                                                BackgroundColor="White"
                                                Stroke="LightGray"
                                                StrokeShape="RoundRectangle 8">

                                                <Border.GestureRecognizers>
                                                    <TapGestureRecognizer Command="{Binding BindingContext.SwitchToSchedulePageSelectAppointmentCommand, Source={x:Reference PatientHomePage}}" CommandParameter="{Binding .}" />
                                                </Border.GestureRecognizers>

                                                <Label
                                                    FontSize="12"
                                                    HorizontalTextAlignment="Center"
                                                    TextColor="Black"
                                                    VerticalTextAlignment="Center">
                                                    <Label.FormattedText>
                                                        <FormattedString>
                                                            <Span FontFamily="AppIcons" Text="&#xf133;" />
                                                            <Span FontAttributes="Bold" Text="   Agendar Exame   " />
                                                            <Span FontFamily="AppIcons" Text="&#xe813;" />
                                                        </FormattedString>
                                                    </Label.FormattedText>
                                                </Label>
                                            </Border>
                                        </StackLayout>
                                    </Border>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </StackLayout>
                </Border>

                <Border
                    Padding="18"
                    BackgroundColor="White"
                    Shadow="{StaticResource BottomShadow}"
                    StrokeShape="RoundRectangle 8"
                    StrokeThickness="0.5">

                    <Border.Behaviors>
                        <behaviors:BorderDismissBehavior />
                    </Border.Behaviors>

                    <VerticalStackLayout Spacing="10">
                        <FlexLayout JustifyContent="Center">
                            <Border
                                Padding="13"
                                BackgroundColor="#dbeafe"
                                Stroke="Transparent"
                                StrokeShape="40">
                                <Label
                                    FontAttributes="Bold"
                                    FontFamily="AppIcons"
                                    FontSize="Medium"
                                    Text="&#xe80d;"
                                    TextColor="#145efc" />
                            </Border>
                        </FlexLayout>
                        <Label
                            Padding="0,10,0,0"
                            FontFamily=""
                            FontSize="13"
                            HorizontalTextAlignment="Center">
                            <Label.FormattedText>
                                <FormattedString>
                                    <Span FontAttributes="Bold" Text="Vi" />
                                    <Span
                                        FontAttributes="Bold"
                                        Text="ver"
                                        TextColor="Blue" />
                                    <Span FontAttributes="Bold" Text=": Cuidando da sua " />
                                    <Span
                                        FontAttributes="Bold"
                                        Text="visão"
                                        TextColor="Blue" />
                                </FormattedString>
                            </Label.FormattedText>
                        </Label>
                        <Label
                            FontSize="12"
                            HorizontalTextAlignment="Center"
                            LineBreakMode="WordWrap"
                            LineHeight="1.5"
                            Text="Mantenha seus exames em dia e siga as orientações médicas para preservar sua saúde ocular."
                            TextColor="Gray" />
                    </VerticalStackLayout>
                </Border>

                <Border
                    Padding="18"
                    BackgroundColor="{StaticResource BackgroundGreen}"
                    Shadow="{StaticResource BottomShadow}"
                    StrokeShape="RoundRectangle 8"
                    StrokeThickness="0.5">

                    <Border.Behaviors>
                        <behaviors:BorderDismissBehavior />
                    </Border.Behaviors>

                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding ShowDMCareAppCommand}" />
                    </Border.GestureRecognizers>

                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="8">
                        <Label
                            Grid.Column="0"
                            FontFamily="AppIcons"
                            FontSize="14"
                            Text="&#xe83e;"
                            TextColor="Green" />
                        <StackLayout Grid.Column="1" Spacing="8">
                            <Label
                                FontSize="12"
                                LineHeight="1.3"
                                TextColor="DarkGreen">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span FontAttributes="Bold" Text="DMCare - Programa para Diabéticos: " />
                                        <Span Text="Cuidadados especializados para pacientes diabéticos. Consultas preventivas e acompanhamentos da saúde ocular para quem tem diabetes" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                            <Grid ColumnDefinitions="1.2*,*">
                                <Border
                                    BackgroundColor="#00a63e"
                                    Stroke="Transparent"
                                    StrokeShape="4">
                                    <Label
                                        Padding="9,6,6,6"
                                        FontSize="12"
                                        TextColor="White">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span FontFamily="AppIcons" Text="&#xe811;" />
                                                <Span FontAttributes="Bold" Text="   Conhecer o Aplicativo" />
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                </Border>
                            </Grid>
                        </StackLayout>
                    </Grid>
                </Border>
            </VerticalStackLayout>
        </ScrollView>
    </RefreshView>
</ContentView>
